name: Code Checks
on: [push]
jobs:
  qa:
    name: Checking Code
    runs-on: ubuntu-latest

    steps:
        - uses: actions/checkout@v2

        - name: Setup Python
          uses: actions/setup-python@v2
          with:
            python-version: 3.7

        # - name: Setup Pipenv
        #   uses: dschep/install-pipenv-action@v1

        # - name: Setup Cache
        #   id: pip-cache
        #   uses: actions/cache@v1
        #   with:
        #     path: ~/.local
        #     key: v1-${{ runner.os }}-${{ hashFiles('**/Pipfile.lock' )}}

        - name: Setup Cache
          id: cache
          uses: actions/cache@v2
          with:
            path: ~/.cache/pip
            key: ${{ runner.os }}-pip-${{ hashFiles('**/**/requirements/dev.txt' ) }}
            restore-keys: |
              ${{ runner.os }}-pip-  

        - name: Setup flake8 annotations
          uses: rbialon/flake8-annotations@v1

        # - name: Install Python Dependences, run linting and import sorting
        #   run: |
        #     pipenv --python 3.7 install --dev
        #     pipenv run isort -c **/*.py
        #     pipenv run flake8 --show-source hedera lattices lemmatization lemmatized_text vocab_list lti

        - name: Install Python Dependences, run linting and import sorting
          run: |
            pip install -r hedera/requirements/dev.txt
            isort -c **/*.py
            flake8 --show-source hedera lattices lemmatization lemmatized_text vocab_list lti


        - name: Install Static Dependences
          run: npm i --dev

        - name: Lint JavaScript
          run: npm run lint